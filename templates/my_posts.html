{% extends "base.html" %}
{% block title %}ë‚´ê°€ ì“´ ê¸€ - MONEYING{% endblock %}

{% block content %}

<div class="max-w-2xl mx-auto">

  <div class="mb-6">
    <a href="/my" class="text-zinc-500 hover:text-white transition text-sm">â† ë‚´ì •ë³´</a>
    <h1 class="text-2xl font-black mt-4">ë‚´ê°€ ì“´ ê¸€</h1>
    <p class="text-zinc-400 mt-1 text-sm">ì´ {{ posts|length }}ê°œ</p>
  </div>

  {% if posts|length == 0 %}
  <div class="bg-zinc-900/60 border border-zinc-800 rounded-2xl p-10 text-center">
    <div class="text-4xl mb-4">âœï¸</div>
    <div class="text-zinc-400 font-bold mb-4">ì•„ì§ ì‘ì„±í•œ ê¸€ì´ ì—†ì–´ìš”</div>
    <a href="/community/write" class="inline-block bg-[#c4ff00] text-black font-bold px-6 py-3 rounded-xl hover:bg-white transition">
      ê¸€ì“°ê¸°
    </a>
  </div>
  {% else %}
  
  <div class="space-y-2">
    {% for post in posts %}
    <div class="bg-zinc-900/60 border border-zinc-800 rounded-xl px-4 py-3 hover:border-zinc-700 transition flex items-center gap-3">
      
      <!-- ì™¼ìª½: ì•„ì´ì½˜ + ì œëª© -->
      <a href="/community/{{ post.id }}" class="flex-1 min-w-0 flex items-center gap-3 group">
        <span class="text-lg shrink-0">
          {% if post.category == 'notice' %}ğŸ“¢{% elif post.category == 'deal' %}ğŸ›ï¸{% elif post.category == 'revenue' %}ğŸ’¸{% elif post.category == 'tips' %}ğŸ’¡{% elif post.category == 'qna' %}â“{% else %}ğŸ—£{% endif %}
        </span>
        <div class="min-w-0">
          <h3 class="text-white font-medium group-hover:text-[#c4ff00] transition truncate">{{ post.title }}</h3>
          <span class="text-zinc-500 text-xs">{{ post.created_at.strftime('%m/%d') }}</span>
        </div>
      </a>
      
      <!-- ì˜¤ë¥¸ìª½: ë²„íŠ¼ë“¤ -->
      <div class="flex items-center gap-2 shrink-0">
        <a href="/community/{{ post.id }}/edit" class="text-zinc-500 hover:text-[#c4ff00] text-xs transition">ìˆ˜ì •</a>
        <button onclick="deletePost({{ post.id }})" class="text-zinc-500 hover:text-red-500 text-xs transition">ì‚­ì œ</button>
      </div>
      
    </div>
    {% endfor %}
  </div>
  
  {% endif %}

  <div class="mt-6">
    <a href="/community/write" class="block w-full bg-[#c4ff00] text-black font-bold py-4 rounded-xl text-center hover:bg-white transition">
      ìƒˆ ê¸€ ì“°ê¸°
    </a>
  </div>

</div>

<!-- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
<div id="deleteModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center">
  <div class="bg-zinc-900 border border-zinc-700 rounded-2xl p-6 max-w-sm mx-4 text-center">
    <div class="text-4xl mb-4">ğŸ—‘ï¸</div>
    <h3 class="text-xl font-black text-white mb-2">ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</h3>
    <p class="text-zinc-400 text-sm mb-6">ì‚­ì œëœ ê¸€ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
    <div class="flex gap-3">
      <button onclick="closeDeleteModal()" class="flex-1 py-3 rounded-xl font-bold border border-zinc-600 text-white hover:bg-zinc-800 transition">ì·¨ì†Œ</button>
      <form id="deleteForm" method="POST" class="flex-1">
        <button type="submit" class="w-full py-3 rounded-xl font-bold bg-red-500 text-white hover:bg-red-400 transition">ì‚­ì œ</button>
      </form>
    </div>
  </div>
</div>

<script>
function deletePost(postId) {
  document.getElementById('deleteForm').action = `/community/${postId}/delete`;
  document.getElementById('deleteModal').classList.remove('hidden');
  document.getElementById('deleteModal').classList.add('flex');
}

function closeDeleteModal() {
  document.getElementById('deleteModal').classList.add('hidden');
  document.getElementById('deleteModal').classList.remove('flex');
}

document.getElementById('deleteModal').addEventListener('click', function(e) {
  if (e.target === this) closeDeleteModal();
});
</script>

{% endblock %}