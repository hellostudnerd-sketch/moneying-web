{% extends "admin_base.html" %}
{% block title %}ì§€ì‹ ìŠ¤í† ì–´ ê´€ë¦¬ - MONEYING Admin{% endblock %}
{% block page_title %}ì§€ì‹ ìŠ¤í† ì–´ ê´€ë¦¬{% endblock %}
{% block page_desc %}ìƒí’ˆ {{ products|length }}ê°œ{% endblock %}

{% block page_actions %}
<a href="/admin/store/new" class="px-4 py-2 rounded-xl bg-[#a3e635] text-black font-black hover:bg-white transition">
  + ìƒí’ˆ ì¶”ê°€
</a>
{% endblock %}

{% block content_admin %}
<div class="bg-zinc-900/60 border border-zinc-800 rounded-2xl overflow-hidden">
  <div class="flex items-center justify-between px-5 py-4 border-b border-zinc-800">
    <div class="font-black">ìƒí’ˆ ëª©ë¡</div>
  </div>
  
  {% if products|length == 0 %}
    <div class="p-10 text-center">
      <div class="text-4xl mb-4">ğŸ“¦</div>
      <div class="text-zinc-500 font-bold">ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
    </div>
  {% else %}
    <table class="w-full">
      <thead class="bg-zinc-800/50">
        <tr>
          <th class="px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase">ìƒí’ˆ</th>
          <th class="px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase">ì¹´í…Œê³ ë¦¬</th>
          <th class="px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase">ê°€ê²©</th>
          <th class="px-6 py-4 text-left text-xs font-bold text-zinc-500 uppercase">ìƒíƒœ</th>
          <th class="px-6 py-4 text-right text-xs font-bold text-zinc-500 uppercase">ì•¡ì…˜</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-zinc-800/70">
        {% for p in products %}
          <tr class="hover:bg-zinc-800/30 transition">
            <td class="px-6 py-4">
              <div class="flex items-center gap-4">
                {% if p.image %}
                  <img src="{{ p.image }}" class="w-12 h-12 rounded-lg object-cover">
                {% else %}
                  <div class="w-12 h-12 rounded-lg bg-zinc-800 flex items-center justify-center text-xl">ğŸ“¦</div>
                {% endif %}
                <div>
                  <div class="font-bold text-white">{{ p.title }}</div>
                  {% if p.badge %}<span class="text-xs text-[#a3e635]">{{ p.badge }}</span>{% endif %}
                </div>
              </div>
            </td>
            <td class="px-6 py-4 text-zinc-400">
              {{ {'ebook':'ì „ìì±…','vod':'VOD ê°•ì˜','program':'í”„ë¡œê·¸ë¨','template':'í…œí”Œë¦¿'}.get(p.category, p.category) }}
            </td>
            <td class="px-6 py-4 text-white font-bold">{{ "{:,}".format(p.price) }}ì›</td>
            <td class="px-6 py-4">
              {% if p.is_active %}
                <span class="px-3 py-1 rounded-full bg-green-500/10 text-green-400 border border-green-500/20 text-xs font-bold">íŒë§¤ì¤‘</span>
              {% else %}
                <span class="px-3 py-1 rounded-full bg-zinc-500/10 text-zinc-400 border border-zinc-500/20 text-xs font-bold">ë¹„ê³µê°œ</span>
              {% endif %}
            </td>
            <td class="px-6 py-4 text-right">
              <a href="/admin/store/{{ p.id }}/edit" class="text-[#a3e635] hover:underline text-sm font-bold mr-3">ìˆ˜ì •</a>
              <button onclick="deleteProduct({{ p.id }})" class="text-red-400 hover:underline text-sm font-bold">ì‚­ì œ</button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
</div>

<script>
function deleteProduct(id) {
  if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  fetch(`/admin/store/${id}/delete`, { method: 'POST' })
    .then(() => location.reload());
}
</script>
{% endblock %}